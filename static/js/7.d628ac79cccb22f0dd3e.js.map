{"version":3,"sources":["webpack:///./src/components/top-list/top-list.vue?698b","webpack:///./src/components/top-list/top-list.vue?b32f","webpack:///./src/api/rank.js","webpack:///src/components/top-list/top-list.vue","webpack:///./src/components/top-list/top-list.vue?13c8","webpack:///./src/components/top-list/top-list.vue"],"names":["module","exports","__webpack_require__","push","i","version","sources","names","mappings","file","sourcesContent","sourceRoot","content","locals","Object","__WEBPACK_IMPORTED_MODULE_1__common_js_jsonp__","g_tk","hostUin","format","inCharset","outCharset","notice","platform","data","toplist","method","param","topid","date","type","typeFormat","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default","__WEBPACK_IMPORTED_MODULE_2__config__","tpl","page","song_begin","song_num","needNewCode","MusicList","music_list","_getMusicList","_this","this","songlist","vkey","url","musicData","ret","computed","extends_default","vuex_esm","name","image","pic","top_list_top_list","render","_h","$createElement","_c","_self","attrs","rank","title","bgImage","songs","staticRenderFns","Component","normalizeComponent","top_list","ssrContext","__webpack_exports__"],"mappings":"0CAAAA,EAAAC,QAAAC,EAAA,OAAAA,EAAA,IAKAC,MAAAH,EAAAI,EAAA,8TAAqV,IAAQC,QAAA,EAAAC,SAAA,oFAAAC,SAAAC,SAAA,6EAAuMC,KAAA,eAAAC,gBAAA,+TAA2WC,WAAA,4BCF/4B,IAAAC,EAAAV,EAAA,QACA,iBAAAU,QAAAZ,EAAAI,EAAAQ,EAAA,MACAA,EAAAC,SAAAb,EAAAC,QAAAW,EAAAC,QAEAX,EAAA,OAAAA,CAAA,WAAAU,GAAA,0CCHO,WA2EL,OAAOE,OAAAC,EAAA,EAAAD,CAxEK,yCAEVE,KAAM,KAENC,QAAS,EACTC,OAAQ,OACRC,UAAW,OACXC,WAAY,QACZC,OAAQ,EACRC,SAAU,MAEVC,MA+CEC,SACExB,OAAU,wBACVyB,OAAU,oBACVC,YAWkB,SAInB,SAAsBC,EAAOC,EAAMC,GAGxC,IAAMC,EAAsB,IAATD,EAAa,MAAQ,SAElCN,EAAOQ,OAAkBC,EAAA,GAC7BL,QACAM,IAAK,EACLC,KAAM,SACNN,OACAC,KAAMC,EACNK,WAAY,EACZC,SAAU,GACVpB,KAAM,UACNC,QAAS,EACTC,OAAQ,QACRC,UAAW,OACXC,WAAY,QACZC,OAAQ,EACRC,SAAU,MACVe,YAAa,IAEf,OAAOvB,OAAAC,EAAA,EAAAD,CAlBK,sDAkBMS,EAAMS,EAAA,8QCxF1BM,UAAAC,EAAA,yCAKA,4BAGAC,mDAGA,IAAAC,EAAAC,uJASAC,qCALA,iFAYApB,uFAIAqB,4EACAA,EAAA,2CACAC,2BACAC,sCAEA,uCAIAC,IAGAC,SAAAC,OAAAnC,OAAAoC,EAAA,EAAApC,EAGA,kDAEAqC,gEAIAC,mBAEAC,QCpEAC,GADiBC,OAFjB,WAA0B,IAAaC,EAAbd,KAAae,eAA0BC,EAAvChB,KAAuCiB,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,cAAwBE,OAAOT,KAAA,WAAgBO,EAAA,cAAmBE,OAAOC,KAAxInB,KAAwImB,KAAAC,MAAxIpB,KAAwIoB,MAAAC,QAAxIrB,KAAwIqB,QAAAC,MAAxItB,KAAwIsB,UAA2E,IAE5NC,oBCcjBC,EAbAhE,EAAA,OAaAiE,CACAC,EACAd,GATA,EATA,SAAAe,GACAnE,EAAA,SAYA,kBAEA,MAUAoE,EAAA,QAAAJ,EAAA","file":"static/js/7.d628ac79cccb22f0dd3e.js","sourcesContent":["exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\\n.slide-enter-active[data-v-1afc84f1],\\n.slide-leave-active[data-v-1afc84f1] {\\n  -webkit-transition: all 0.3s ease;\\n  transition: all 0.3s ease;\\n}\\n.slide-enter[data-v-1afc84f1],\\n.slide-leave-to[data-v-1afc84f1] {\\n  -webkit-transform: translate3d(100%, 0, 0);\\n          transform: translate3d(100%, 0, 0);\\n}\", \"\", {\"version\":3,\"sources\":[\"/Users/yudong/Documents/myproject/vue-music/src/components/top-list/top-list.vue\"],\"names\":[],\"mappings\":\";AACA;;EAEE,kCAAkC;EAClC,0BAA0B;CAC3B;AACD;;EAEE,2CAA2C;UACnC,mCAAmC;CAC5C\",\"file\":\"top-list.vue\",\"sourcesContent\":[\"\\n.slide-enter-active[data-v-1afc84f1],\\n.slide-leave-active[data-v-1afc84f1] {\\n  -webkit-transition: all 0.3s ease;\\n  transition: all 0.3s ease;\\n}\\n.slide-enter[data-v-1afc84f1],\\n.slide-leave-to[data-v-1afc84f1] {\\n  -webkit-transform: translate3d(100%, 0, 0);\\n          transform: translate3d(100%, 0, 0);\\n}\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-1afc84f1\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/components/top-list/top-list.vue\n// module id = +pCJ\n// module chunks = 7","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1afc84f1\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/stylus-loader/index.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./top-list.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"2347025c\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-1afc84f1\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/components/top-list/top-list.vue\n// module id = BPxl\n// module chunks = 7","import jsonp from '@/common/js/jsonp'\nimport { commonParams, options } from './config'\n// import axios from 'axios'\n\nexport function getTopList() {\n  // 下面这一行是抓取的请求链接（未删减版）\n  // conso url = 'https://u.y.qq.com/cgi-bin/musicu.fcg?callback=recom41583483471570526&g_tk=5381&jsonpCallback=recom41583483471570526&loginUin=0&hostUin=0&format=jsonp&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0&data=%7B%22comm%22%3A%7B%22ct%22%3A24%7D%2C%22recomPlaylist%22%3A%7B%22method%22%3A%22get_hot_recommend%22%2C%22param%22%3A%7B%22async%22%3A1%2C%22cmd%22%3A2%7D%2C%22module%22%3A%22playlist.HotRecommendServer%22%7D%2C%22playlist%22%3A%7B%22method%22%3A%22get_playlist_by_category%22%2C%22param%22%3A%7B%22id%22%3A8%2C%22curPage%22%3A1%2C%22size%22%3A40%2C%22order%22%3A5%2C%22titleid%22%3A8%7D%2C%22module%22%3A%22playlist.PlayListPlazaServer%22%7D%2C%22new_song%22%3A%7B%22module%22%3A%22QQMusic.MusichallServer%22%2C%22method%22%3A%22GetNewSong%22%2C%22param%22%3A%7B%22type%22%3A0%7D%7D%2C%22new_album%22%3A%7B%22module%22%3A%22QQMusic.MusichallServer%22%2C%22method%22%3A%22GetNewAlbum%22%2C%22param%22%3A%7B%22type%22%3A0%2C%22category%22%3A%22-1%22%2C%22genre%22%3A0%2C%22year%22%3A1%2C%22company%22%3A-1%2C%22sort%22%3A1%2C%22start%22%3A0%2C%22end%22%3A39%7D%7D%2C%22toplist%22%3A%7B%22module%22%3A%22music.web_toplist_svr%22%2C%22method%22%3A%22get_toplist_index%22%2C%22param%22%3A%7B%7D%7D%2C%22focus%22%3A%7B%22module%22%3A%22QQMusic.MusichallServer%22%2C%22method%22%3A%22GetFocus%22%2C%22param%22%3A%7B%7D%7D%7D'\n  const url = 'https://u.y.qq.com/cgi-bin/musicu.fcg'\n  const data = {\n    g_tk: 5381,\n    // jsonpCallback: 'recom2586478241234471',\n    hostUin: 0,\n    format: 'json',\n    inCharset: 'utf8',\n    outCharset: 'utf-8',\n    notice: 0,\n    platform: 'yqq',\n    // 由于我们这里只抓取recomPlaylist的数据，所以其他的请求项，我们不传\n    data: {\n      // 'comm': {'ct': 24},\n      // 'category': {\n      //   'method': 'get_hot_category',\n      //   'param': {'qq': ''},\n      //   'module': 'music.web_category_svr'\n      // },\n      // 'recomPlaylist': {\n      //   'method': 'get_hot_recommend',\n      //   'param': {\n      //     'async': 1,\n      //     'cmd': 2\n      //   },\n      //   'module': 'playlist.HotRecommendServer'\n      // }\n      // 'playlist': {\n      //   'method': 'get_playlist_by_category',\n      //   'param': {\n      //     'id': 8,\n      //     'curPage': 1,\n      //     'size': 40,\n      //     'order': 5,\n      //     'titleid': 8\n      //   },\n      //   'module': 'playlist.PlayListPlazaServer'\n      // },\n      // 'new_song': {\n      //   'module': 'QQMusic.MusichallServer',\n      //   'method': 'GetNewSong',\n      //   'param': {\n      //     'type': 0\n      //   }\n      // },\n      // 'new_album': {\n      //   'module': 'QQMusic.MusichallServer',\n      //   'method': 'GetNewAlbum',\n      //   'param': {\n      //     'type': 0,\n      //     'category': '-1',\n      //     'genre': 0,\n      //     'year': 1,\n      //     'company': -1,\n      //     'sort': 1,\n      //     'start': 0,\n      //     'end': 39\n      //   }\n      // },\n      'toplist': {\n        'module': 'music.web_toplist_svr',\n        'method': 'get_toplist_index',\n        'param': {}\n      }\n      // 'focus': {\n      //   'module': 'QQMusic.MusichallServer',\n      //   'method': 'GetFocus',\n      //   'param': {}\n      // }\n    }\n  }\n  // 因为我们的 options 里面配的回调函数的 jsonpCallback\n  // 而这个接口的回调是 callback ，所以我们不传，默认就是 callback\n  return jsonp(url, data, '')\n  // return jsonp(url, data, options)\n}\n\nexport function getMusicList(topid, date, type) {\n  // 这个里面的日期只是使用接口中的 update_key 参数传过来\n  // const date = dateFormat(new Date())\n  const typeFormat = type === 0 ? 'top' : 'global'\n  const url = 'https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg'\n  const data = Object.assign({}, commonParams, {\n    topid,\n    tpl: 3,\n    page: 'detail',\n    date,\n    type: typeFormat,\n    song_begin: 0,\n    song_num: 30,\n    g_tk: 788911273,\n    hostUin: 0,\n    format: 'jsonp',\n    inCharset: 'utf8',\n    outCharset: 'utf-8',\n    notice: 0,\n    platform: 'yqq',\n    needNewCode: 0\n  })\n  return jsonp(url, data, options)\n}\n\n/* eslint-disable no-unused-vars */\nfunction dateFormat(date) {\n  // console.log(date.toLocaleDateString().replace(/\\//g, '-'))\n  let month = `0${date.toLocaleDateString().split('/')[1]}`\n  // 当天日期不行，当天的榜单还没出来呢\n  let day = date.toLocaleDateString().split('/')[2] - 1\n  // date.toLocaleDateString().split('/')[1] = month\n  return `${date.toLocaleDateString().split('/')[0]}-${month}-${day}`\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/rank.js","<template>\n  <transition name=\"slide\">\n    <music-list :rank=\"rank\" :title=\"title\" :bgImage=\"bgImage\" :songs=\"songs\"></music-list>\n  </transition>\n</template>\n\n<script>\n  import MusicList from '@/components/music-list/music-list'\n  import {mapGetters} from 'vuex'\n  import {getMusicList} from '@/api/rank'\n  import {ERR_OK} from '@/api/config'\n  import {createSong} from '@/common/js/song'\n  import { getSongUrl } from '@/api/song'\n  export default {\n    components: {\n      MusicList\n    },\n    data() {\n      return {\n        songs: [],\n        rank: true\n      }\n    },\n    created() {\n      this._getMusicList()\n    },\n    methods: {\n      _getMusicList() {\n        if(!this.topList.id) {\n          this.$router.push({\n            path: '/rank'\n          })\n          return\n        }\n        getMusicList(this.topList.id, this.topList.update_key, this.topList.type).then((res) => {\n          if(res.code === ERR_OK) {\n            this.songs = this._normalizeSong(res.songlist)\n          }\n        })\n      },\n      _normalizeSong(list) {\n        let ret = []\n        list.forEach((musicData) => {\n          musicData = musicData.data\n          if(musicData.songid && musicData.albumid) {\n            // ret.push(createSong(musicData))\n            getSongUrl(musicData.songmid).then(resp => {\n              let vkey = resp.data.items[0].vkey\n              let url = `http://dl.stream.qqmusic.qq.com/${resp.data.items[0].filename}?vkey=${vkey}&guid=7175649092&uin=0&fromtag=66`\n              Object.assign(musicData, { url })\n              ret.push(createSong(musicData))\n            }).catch(err => {\n              console.log(err + 'FROM - toplist组件中_normalizeSong')\n            })\n          }\n        })\n        return ret\n      }\n    },\n    computed: {\n      ...mapGetters([\n        'topList'\n      ]),\n      title() {\n        return this.topList.name\n      },\n      bgImage() {\n        if(this.songs.length) {\n          return this.songs[0].image\n        } else {\n          return this.topList.pic\n        }\n      }\n    }\n  }\n</script>\n\n<style scoped lang=\"stylus\">\n  .slide-enter-active, .slide-leave-active\n    transition: all 0.3s ease\n  .slide-enter, .slide-leave-to\n    transform: translate3d(100%, 0, 0)\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/top-list/top-list.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":\"slide\"}},[_c('music-list',{attrs:{\"rank\":_vm.rank,\"title\":_vm.title,\"bgImage\":_vm.bgImage,\"songs\":_vm.songs}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1afc84f1\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/top-list/top-list.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1afc84f1\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./top-list.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./top-list.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1afc84f1\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./top-list.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1afc84f1\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/top-list/top-list.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}